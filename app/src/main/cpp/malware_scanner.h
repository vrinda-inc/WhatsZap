#ifndef WHATSZAP_MALWARE_SCANNER_H
#define WHATSZAP_MALWARE_SCANNER_H

#include <string>
#include <vector>
#include <jni.h>

struct ScanResult {
    bool isMalicious;
    int confidence;
    std::vector<std::string> threats;
    long scanDuration;
    
    ScanResult() : isMalicious(false), confidence(0), scanDuration(0) {}
};

class MalwareScanner {
public:
    MalwareScanner();
    ~MalwareScanner();
    
    // Scan APK file (blocks until complete)
    ScanResult scanApk(const std::string& apkPath);
    
private:
    int analyzeManifest(const std::string& manifestContent, 
                        std::vector<std::string>& threats);
    std::string calculateSimpleHash(const std::string& filePath);
    
    static const std::vector<std::string> SUSPICIOUS_PERMISSIONS;
    static const std::vector<std::string> SUSPICIOUS_PACKAGES;
};

#endif // WHATSZAP_MALWARE_SCANNER_H

